/*
Deployment script for BeyondFitnessTest

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
--:setvar DatabaseName "BeyondFitnessTest"
--:setvar DefaultFilePrefix "BeyondFitnessTest"
--:setvar DefaultDataPath "c:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\DATA\"
--:setvar DefaultLogPath "c:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\DATA\"

GO
--:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
--:setvar __IsSqlCmdEnabled "True"
--GO
--IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
--    BEGIN
--        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
--        SET NOEXEC ON;
--    END


--GO
--USE [$(DatabaseName)];


GO
PRINT N'Dropping [dbo].[FK_TuitionInstallment_IntuitionCharge]...';


GO
ALTER TABLE [dbo].[TuitionInstallment] DROP CONSTRAINT [FK_TuitionInstallment_IntuitionCharge];


GO
PRINT N'Dropping [dbo].[FK_TuitionAchievement_TuitionInstallment]...';


GO
ALTER TABLE [dbo].[TuitionAchievement] DROP CONSTRAINT [FK_TuitionAchievement_TuitionInstallment];


GO
PRINT N'Altering [dbo].[BranchStore]...';


GO
ALTER TABLE [dbo].[BranchStore]
    ADD [ManagerID]     INT NULL,
        [ViceManagerID] INT NULL;


GO
--PRINT N'Altering [dbo].[LessonPriceType]...';


--GO
--ALTER TABLE [dbo].[LessonPriceType]
--    ADD [LowerLimit]        INT NULL,
--        [UpperBound]        INT NULL,
--        [BranchID]          INT NULL,
--        [DiscountedPrice]   INT NULL,
--        [DurationInMinutes] INT NULL,
--        [SeriesID]          INT NULL;


--GO
PRINT N'Starting rebuilding table [dbo].[TuitionInstallment]...';


GO
BEGIN TRANSACTION;

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

SET XACT_ABORT ON;

CREATE TABLE [dbo].[tmp_ms_xx_TuitionInstallment] (
    [InstallmentID] INT      NOT NULL,
    [RegisterID]    INT      NOT NULL,
    [PayoffAmount]  INT      NULL,
    [PayoffDate]    DATETIME NULL,
    CONSTRAINT [tmp_ms_xx_constraint_PK_TuitionInstallment1] PRIMARY KEY CLUSTERED ([InstallmentID] ASC)
);

IF EXISTS (SELECT TOP 1 1 
           FROM   [dbo].[TuitionInstallment])
    BEGIN
        INSERT INTO [dbo].[tmp_ms_xx_TuitionInstallment] ([InstallmentID], [RegisterID], [PayoffAmount], [PayoffDate])
        SELECT   [InstallmentID],
                 [RegisterID],
                 [PayoffAmount],
                 [PayoffDate]
        FROM     [dbo].[TuitionInstallment]
        ORDER BY [InstallmentID] ASC;
    END

DROP TABLE [dbo].[TuitionInstallment];

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_TuitionInstallment]', N'TuitionInstallment';

EXECUTE sp_rename N'[dbo].[tmp_ms_xx_constraint_PK_TuitionInstallment1]', N'PK_TuitionInstallment', N'OBJECT';

COMMIT TRANSACTION;

SET TRANSACTION ISOLATION LEVEL READ COMMITTED;


GO
PRINT N'Altering [dbo].[UserProfileExtension]...';


GO
ALTER TABLE [dbo].[UserProfileExtension]
    ADD [EmergencyContactPhone]  NVARCHAR (32)  NULL,
        [EmergencyContactPerson] NVARCHAR (16)  NULL,
        [Relationship]           NVARCHAR (16)  NULL,
        [IDNo]                   NVARCHAR (16)  NULL,
        [AdministrativeArea]     NVARCHAR (16)  NULL,
        [Signature]              NVARCHAR (MAX) NULL,
        [RegisterStatus]         BIT            NULL;


GO
PRINT N'Creating [dbo].[ContractPayment]...';


GO
CREATE TABLE [dbo].[ContractPayment] (
    [PaymentID]  INT NOT NULL,
    [ContractID] INT NOT NULL,
    CONSTRAINT [PK_ContractPayment] PRIMARY KEY CLUSTERED ([PaymentID] ASC)
);


GO
PRINT N'Creating [dbo].[CourseContract]...';


GO
CREATE TABLE [dbo].[CourseContract] (
    [ContractID]        INT           IDENTITY (1, 1) NOT NULL,
    [ContractType]      INT           NOT NULL,
    [ContractDate]      DATETIME      NULL,
    [Subject]           NVARCHAR (8)  NULL,
    [ValidFrom]         DATETIME      NULL,
    [Expiration]        DATETIME      NULL,
    [OwnerID]           INT           NOT NULL,
    [SequenceNo]        INT           NULL,
    [Lessons]           INT           NULL,
    [PriceID]           INT           NOT NULL,
    [Remark]            NVARCHAR (64) NULL,
    [FitnessConsultant] INT           NOT NULL,
    [Status]            INT           NOT NULL,
    [AgentID]           INT           NOT NULL,
    [ContractNo]        NVARCHAR (64) NULL,
    [TotalCost]         INT           NULL,
    [EffectiveDate]     DATETIME      NULL,
    CONSTRAINT [PK_CourseContract] PRIMARY KEY CLUSTERED ([ContractID] ASC)
);


GO
PRINT N'Creating [dbo].[CourseContract].[IX_CourseContract]...';


GO
CREATE NONCLUSTERED INDEX [IX_CourseContract]
    ON [dbo].[CourseContract]([ContractNo] ASC);


GO
PRINT N'Creating [dbo].[CourseContractLevel]...';


GO
CREATE TABLE [dbo].[CourseContractLevel] (
    [ContractID] INT      NOT NULL,
    [LevelDate]  DATETIME NOT NULL,
    [ExecutorID] INT      NOT NULL,
    [LevelID]    INT      NOT NULL,
    CONSTRAINT [PK_CourseContractLevel] PRIMARY KEY CLUSTERED ([ContractID] ASC, [LevelDate] ASC)
);


GO
PRINT N'Creating [dbo].[CourseContractMember]...';


GO
CREATE TABLE [dbo].[CourseContractMember] (
    [ContractID] INT NOT NULL,
    [UID]        INT NOT NULL,
    CONSTRAINT [PK_CourseContractMember] PRIMARY KEY CLUSTERED ([ContractID] ASC, [UID] ASC)
);


GO
PRINT N'Creating [dbo].[CourseContractRevision]...';


GO
CREATE TABLE [dbo].[CourseContractRevision] (
    [RevisionID]       INT           NOT NULL,
    [OriginalContract] INT           NULL,
    [RevisionNo]       INT           NOT NULL,
    [Reason]           NVARCHAR (16) NULL,
    CONSTRAINT [PK_CourseContractRevision] PRIMARY KEY CLUSTERED ([RevisionID] ASC)
);


GO
PRINT N'Creating [dbo].[CourseContractSignature]...';


GO
CREATE TABLE [dbo].[CourseContractSignature] (
    [SignatureID]   INT           IDENTITY (1, 1) NOT NULL,
    [ContractID]    INT           NOT NULL,
    [UID]           INT           NOT NULL,
    [SignatureName] NVARCHAR (64) NULL,
    [Signature]     VARCHAR (MAX) NULL,
    CONSTRAINT [PK_CourseContractSignature] PRIMARY KEY CLUSTERED ([SignatureID] ASC)
);


GO
PRINT N'Creating [dbo].[CourseContractType]...';


GO
CREATE TABLE [dbo].[CourseContractType] (
    [TypeID]              INT           NOT NULL,
    [TypeName]            NVARCHAR (32) NULL,
    [ContractCode]        NVARCHAR (8)  NULL,
    [IsGroup]             BIT           NULL,
    [GroupingMemberCount] INT           NULL,
    CONSTRAINT [PK_CourseContractType] PRIMARY KEY CLUSTERED ([TypeID] ASC)
);


GO
PRINT N'Creating [dbo].[DerivedDocument]...';


GO
CREATE TABLE [dbo].[DerivedDocument] (
    [DocID]    INT NOT NULL,
    [SourceID] INT NOT NULL,
    CONSTRAINT [PK_DerivedDocument] PRIMARY KEY CLUSTERED ([DocID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceAllowance]...';


GO
CREATE TABLE [dbo].[InvoiceAllowance] (
    [AllowanceID]     INT             NOT NULL,
    [AllowanceNumber] NVARCHAR (16)   NULL,
    [AllowanceType]   TINYINT         NULL,
    [AllowanceDate]   DATETIME        NULL,
    [TotalAmount]     DECIMAL (18, 5) NULL,
    [TaxAmount]       DECIMAL (18, 5) NULL,
    [InvoiceID]       INT             NULL,
    [SellerId]        NVARCHAR (10)   NULL,
    [BuyerId]         NVARCHAR (10)   NULL,
    CONSTRAINT [PK_InvoiceAllowance] PRIMARY KEY CLUSTERED ([AllowanceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceAllowanceBuyer]...';


GO
CREATE TABLE [dbo].[InvoiceAllowanceBuyer] (
    [AllowanceID]    INT            NOT NULL,
    [BuyerID]        INT            NULL,
    [Name]           NVARCHAR (128) NULL,
    [CustomerName]   NVARCHAR (64)  NULL,
    [ReceiptNo]      NVARCHAR (10)  NULL,
    [PostCode]       NVARCHAR (8)   NULL,
    [Address]        NVARCHAR (128) NULL,
    [CustomerID]     NVARCHAR (64)  NULL,
    [ContactName]    NVARCHAR (64)  NULL,
    [Phone]          NVARCHAR (64)  NULL,
    [EMail]          NVARCHAR (512) NULL,
    [Fax]            NVARCHAR (64)  NULL,
    [PersonInCharge] NVARCHAR (64)  NULL,
    [RoleRemark]     NVARCHAR (64)  NULL,
    CONSTRAINT [PK_InvoiceAllowanceBuyer] PRIMARY KEY CLUSTERED ([AllowanceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceAllowanceCancellation]...';


GO
CREATE TABLE [dbo].[InvoiceAllowanceCancellation] (
    [AllowanceID]  INT            NOT NULL,
    [CancelDate]   DATETIME       NULL,
    [Remark]       NVARCHAR (256) NULL,
    [CancelReason] NVARCHAR (256) NULL,
    CONSTRAINT [PK_InvoiceAllowanceCancellation] PRIMARY KEY CLUSTERED ([AllowanceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceAllowanceDetails]...';


GO
CREATE TABLE [dbo].[InvoiceAllowanceDetails] (
    [AllowanceID] INT NOT NULL,
    [ItemID]      INT NOT NULL,
    CONSTRAINT [PK_InvoiceAllowanceDetails] PRIMARY KEY CLUSTERED ([AllowanceID] ASC, [ItemID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceAllowanceItem]...';


GO
CREATE TABLE [dbo].[InvoiceAllowanceItem] (
    [ItemID]              INT             IDENTITY (1, 1) NOT NULL,
    [No]                  SMALLINT        NULL,
    [InvoiceNo]           NVARCHAR (16)   NULL,
    [Piece]               DECIMAL (18, 5) NULL,
    [Amount]              DECIMAL (18, 5) NULL,
    [Tax]                 DECIMAL (18, 5) NULL,
    [ProductItemID]       INT             NULL,
    [InvoiceDate]         DATETIME        NULL,
    [ItemNo]              NVARCHAR (16)   NULL,
    [OriginalSequenceNo]  SMALLINT        NULL,
    [PieceUnit]           NVARCHAR (16)   NULL,
    [OriginalDescription] NVARCHAR (256)  NULL,
    [TaxType]             TINYINT         NULL,
    [UnitCost]            DECIMAL (18, 5) NULL,
    [UnitCost2]           DECIMAL (18, 5) NULL,
    [Piece2]              DECIMAL (18, 5) NULL,
    [Amount2]             DECIMAL (18, 5) NULL,
    [PieceUnit2]          NVARCHAR (16)   NULL,
    [Remark]              NVARCHAR (MAX)  NULL,
    CONSTRAINT [PK_InvoiceAllowanceItem] PRIMARY KEY CLUSTERED ([ItemID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceAllowanceSeller]...';


GO
CREATE TABLE [dbo].[InvoiceAllowanceSeller] (
    [AllowanceID]    INT            NOT NULL,
    [SellerID]       INT            NULL,
    [Name]           NVARCHAR (128) NULL,
    [CustomerName]   NVARCHAR (64)  NULL,
    [ReceiptNo]      NVARCHAR (10)  NULL,
    [PostCode]       NVARCHAR (8)   NULL,
    [Address]        NVARCHAR (128) NULL,
    [CustomerID]     NVARCHAR (64)  NULL,
    [ContactName]    NVARCHAR (64)  NULL,
    [Phone]          NVARCHAR (64)  NULL,
    [EMail]          NVARCHAR (512) NULL,
    [Fax]            NVARCHAR (64)  NULL,
    [PersonInCharge] NVARCHAR (64)  NULL,
    [RoleRemark]     NVARCHAR (64)  NULL,
    CONSTRAINT [PK_InvoiceAllowanceSeller] PRIMARY KEY CLUSTERED ([AllowanceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceAmountType]...';


GO
CREATE TABLE [dbo].[InvoiceAmountType] (
    [InvoiceID]              INT             NOT NULL,
    [TaxType]                TINYINT         NULL,
    [SalesAmount]            DECIMAL (18, 5) NULL,
    [TaxAmount]              DECIMAL (18, 5) NULL,
    [TaxRate]                DECIMAL (18, 5) NULL,
    [TotalAmount]            DECIMAL (18, 5) NULL,
    [TotalAmountInChinese]   NVARCHAR (32)   NULL,
    [DiscountAmount]         DECIMAL (18, 5) NULL,
    [Adjustment]             DECIMAL (18, 5) NULL,
    [OriginalCurrencyAmount] DECIMAL (18, 5) NULL,
    [ExchangeRate]           DECIMAL (18, 5) NULL,
    [CurrencyID]             INT             NULL,
    CONSTRAINT [PK_InvoiceAmountType] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceBuyer]...';


GO
CREATE TABLE [dbo].[InvoiceBuyer] (
    [InvoiceID]      INT            NOT NULL,
    [ReceiptNo]      NVARCHAR (10)  NULL,
    [PostCode]       NVARCHAR (8)   NULL,
    [Address]        NVARCHAR (128) NULL,
    [Name]           NVARCHAR (128) NULL,
    [BuyerID]        INT            NULL,
    [CustomerID]     NVARCHAR (64)  NULL,
    [ContactName]    NVARCHAR (64)  NULL,
    [Phone]          NVARCHAR (64)  NULL,
    [EMail]          NVARCHAR (512) NULL,
    [CustomerName]   NVARCHAR (64)  NULL,
    [Fax]            NVARCHAR (64)  NULL,
    [PersonInCharge] NVARCHAR (64)  NULL,
    [RoleRemark]     NVARCHAR (64)  NULL,
    [CustomerNumber] NVARCHAR (20)  NULL,
    CONSTRAINT [PK_InvoiceBuyer] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceCancellation]...';


GO
CREATE TABLE [dbo].[InvoiceCancellation] (
    [CancellationNo]      NVARCHAR (16)  NULL,
    [CancelDate]          DATETIME       NULL,
    [CancelReason]        NVARCHAR (256) NULL,
    [ReturnTaxDocumentNo] NVARCHAR (64)  NULL,
    [Remark]              NVARCHAR (256) NULL,
    [InvoiceID]           INT            NOT NULL,
    CONSTRAINT [PK_InvoiceCancellation] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceCarrier]...';


GO
CREATE TABLE [dbo].[InvoiceCarrier] (
    [InvoiceID]   INT           NOT NULL,
    [CarrierType] NVARCHAR (16) NOT NULL,
    [CarrierNo]   NVARCHAR (64) NULL,
    [CarrierNo2]  NVARCHAR (64) NULL,
    CONSTRAINT [PK_InvoiceCarrier] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceDetails]...';


GO
CREATE TABLE [dbo].[InvoiceDetails] (
    [InvoiceID] INT NOT NULL,
    [ProductID] INT NOT NULL,
    CONSTRAINT [PK_InvoiceDetails] PRIMARY KEY CLUSTERED ([InvoiceID] ASC, [ProductID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceDonation]...';


GO
CREATE TABLE [dbo].[InvoiceDonation] (
    [InvoiceID]  INT           NOT NULL,
    [AgencyCode] NVARCHAR (64) NOT NULL,
    CONSTRAINT [PK_InvoiceDonation] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceItem]...';


GO
CREATE TABLE [dbo].[InvoiceItem] (
    [InvoiceID]            INT            NOT NULL,
    [No]                   NVARCHAR (16)  NULL,
    [InvoiceDate]          DATETIME       NULL,
    [CheckNo]              NVARCHAR (10)  NULL,
    [Remark]               NVARCHAR (256) NULL,
    [BuyerRemark]          NVARCHAR (1)   NULL,
    [CustomsClearanceMark] NVARCHAR (1)   NULL,
    [TaxCenter]            NVARCHAR (40)  NULL,
    [PermitDate]           DATETIME       NULL,
    [PermitWord]           NVARCHAR (40)  NULL,
    [PermitNumber]         NVARCHAR (20)  NULL,
    [Category]             NVARCHAR (2)   NULL,
    [RelateNumber]         NVARCHAR (20)  NULL,
    [InvoiceType]          TINYINT        NULL,
    [GroupMark]            NVARCHAR (2)   NULL,
    [DonateMark]           NVARCHAR (1)   NULL,
    [SellerID]             INT            NULL,
    [DonationID]           INT            NULL,
    [RandomNo]             NVARCHAR (10)  NULL,
    [TrackCode]            NVARCHAR (2)   NULL,
    [BondedAreaConfirm]    TINYINT        NULL,
    [PrintMark]            NVARCHAR (1)   NULL,
    CONSTRAINT [PK_InvoiceItem] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceNoAssignment]...';


GO
CREATE TABLE [dbo].[InvoiceNoAssignment] (
    [InvoiceID]  INT NOT NULL,
    [IntervalID] INT NULL,
    [InvoiceNo]  INT NULL,
    CONSTRAINT [PK_InvoiceNoAssignment] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceNoInterval]...';


GO
CREATE TABLE [dbo].[InvoiceNoInterval] (
    [IntervalID] INT IDENTITY (1, 1) NOT NULL,
    [TrackID]    INT NOT NULL,
    [SellerID]   INT NOT NULL,
    [StartNo]    INT NOT NULL,
    [EndNo]      INT NOT NULL,
    CONSTRAINT [PK_InvoiceNoInterval] PRIMARY KEY CLUSTERED ([IntervalID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceProduct]...';


GO
CREATE TABLE [dbo].[InvoiceProduct] (
    [ProductID] INT            IDENTITY (1, 1) NOT NULL,
    [Brief]     NVARCHAR (256) NULL,
    CONSTRAINT [PK_InvoiceProduct] PRIMARY KEY CLUSTERED ([ProductID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceProductItem]...';


GO
CREATE TABLE [dbo].[InvoiceProductItem] (
    [ItemID]        INT             IDENTITY (1, 1) NOT NULL,
    [ProductID]     INT             NULL,
    [No]            SMALLINT        NULL,
    [Spec]          NVARCHAR (128)  NULL,
    [Piece]         DECIMAL (18, 5) NULL,
    [Piece2]        DECIMAL (18, 5) NULL,
    [PieceUnit]     NVARCHAR (16)   NULL,
    [PieceUnit2]    NVARCHAR (16)   NULL,
    [Weight]        DECIMAL (18, 5) NULL,
    [WeightUnit]    NVARCHAR (16)   NULL,
    [UnitFreight]   DECIMAL (18, 5) NULL,
    [UnitCost]      DECIMAL (18, 5) NULL,
    [UnitCost2]     DECIMAL (18, 5) NULL,
    [FreightAmount] DECIMAL (18, 5) NULL,
    [CostAmount]    DECIMAL (18, 5) NULL,
    [CostAmount2]   DECIMAL (18, 5) NULL,
    [OriginalPrice] DECIMAL (18, 5) NULL,
    [Remark]        NVARCHAR (128)  NULL,
    [RelateNumber]  NVARCHAR (64)   NULL,
    [TaxType]       TINYINT         NULL,
    [ItemNo]        NVARCHAR (16)   NULL,
    CONSTRAINT [PK_InvoiceProductItem] PRIMARY KEY CLUSTERED ([ItemID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoicePurchaseOrder]...';


GO
CREATE TABLE [dbo].[InvoicePurchaseOrder] (
    [InvoiceID]    INT           NOT NULL,
    [UploadID]     INT           NULL,
    [OrderNo]      NVARCHAR (64) NULL,
    [PurchaseDate] DATETIME      NULL,
    CONSTRAINT [PK_InvoicePurchaseOrder] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceSeller]...';


GO
CREATE TABLE [dbo].[InvoiceSeller] (
    [InvoiceID]      INT            NOT NULL,
    [ReceiptNo]      NVARCHAR (10)  NULL,
    [PostCode]       NVARCHAR (8)   NULL,
    [Address]        NVARCHAR (128) NULL,
    [Name]           NVARCHAR (128) NULL,
    [SellerID]       INT            NULL,
    [CustomerID]     NVARCHAR (64)  NULL,
    [ContactName]    NVARCHAR (64)  NULL,
    [Phone]          NVARCHAR (64)  NULL,
    [EMail]          NVARCHAR (512) NULL,
    [CustomerName]   NVARCHAR (64)  NULL,
    [Fax]            NVARCHAR (64)  NULL,
    [PersonInCharge] NVARCHAR (64)  NULL,
    [RoleRemark]     NVARCHAR (64)  NULL,
    CONSTRAINT [PK_InvoiceSeller] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceTrackCode]...';


GO
CREATE TABLE [dbo].[InvoiceTrackCode] (
    [TrackID]   INT          IDENTITY (1, 1) NOT NULL,
    [TrackCode] NVARCHAR (2) NOT NULL,
    [Year]      SMALLINT     NOT NULL,
    [PeriodNo]  SMALLINT     NOT NULL,
    CONSTRAINT [PK_InvoiceTrackCode] PRIMARY KEY CLUSTERED ([TrackID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceTrackCodeAssignment]...';


GO
CREATE TABLE [dbo].[InvoiceTrackCodeAssignment] (
    [TrackID]  INT NOT NULL,
    [SellerID] INT NOT NULL,
    CONSTRAINT [PK_InvoiceTrackCodeAssignment] PRIMARY KEY CLUSTERED ([TrackID] ASC, [SellerID] ASC)
);


GO
PRINT N'Creating [dbo].[InvoiceWinningNumber]...';


GO
CREATE TABLE [dbo].[InvoiceWinningNumber] (
    [WinningNO]        NVARCHAR (16) NOT NULL,
    [Year]             INT           NOT NULL,
    [MonthFrom]        TINYINT       NOT NULL,
    [MonthTo]          TINYINT       NOT NULL,
    [WinningType]      NVARCHAR (64) NULL,
    [InvoiceID]        INT           NOT NULL,
    [TrackCode]        NVARCHAR (2)  NULL,
    [DataType]         NVARCHAR (1)  NULL,
    [BonusDescription] NVARCHAR (32) NULL,
    [WinningID]        INT           NULL,
    [DownloadDate]     DATETIME      NULL,
    CONSTRAINT [PK_InvoiceWinningNumber] PRIMARY KEY CLUSTERED ([InvoiceID] ASC)
);


GO
--PRINT N'Creating [dbo].[LessonPriceProperty]...';


--GO
--CREATE TABLE [dbo].[LessonPriceProperty] (
--    [PriceID]    INT NOT NULL,
--    [PropertyID] INT NOT NULL,
--    CONSTRAINT [PK_LessonPriceProperty] PRIMARY KEY CLUSTERED ([PriceID] ASC, [PropertyID] ASC)
--);


GO
--PRINT N'Creating [dbo].[LessonPriceSeries]...';


--GO
--CREATE TABLE [dbo].[LessonPriceSeries] (
--    [PriceID]  INT NOT NULL,
--    [Year]     INT NULL,
--    [PeriodNo] INT NULL,
--    [Status]   INT NULL,
--    CONSTRAINT [PK_LessonPriceSeries] PRIMARY KEY CLUSTERED ([PriceID] ASC)
--);


GO
--PRINT N'Creating [dbo].[MerchandiseTransaction]...';


--GO
--CREATE TABLE [dbo].[MerchandiseTransaction] (
--    [TransactionID] INT NOT NULL,
--    [ProductID]     INT NOT NULL,
--    CONSTRAINT [PK_MerchandiseTransaction] PRIMARY KEY CLUSTERED ([TransactionID] ASC, [ProductID] ASC)
--);


--GO
--PRINT N'Creating [dbo].[MerchandiseTransactionType]...';


--GO
--CREATE TABLE [dbo].[MerchandiseTransactionType] (
--    [TransactionID]   INT           NOT NULL,
--    [TransactionType] NVARCHAR (16) NULL,
--    CONSTRAINT [PK_MerchandiseTransactionType] PRIMARY KEY CLUSTERED ([TransactionID] ASC)
--);


--GO
--PRINT N'Creating [dbo].[MerchandiseWindow]...';


--GO
--CREATE TABLE [dbo].[MerchandiseWindow] (
--    [ProductID]   INT           IDENTITY (1, 1) NOT NULL,
--    [ProductName] NVARCHAR (32) NOT NULL,
--    [UnitPrice]   INT           NULL,
--    [Status]      INT           NULL,
--    CONSTRAINT [PK_MerchandiseWindow] PRIMARY KEY CLUSTERED ([ProductID] ASC)
--);


--GO
PRINT N'Creating [dbo].[Organization]...';


GO
CREATE TABLE [dbo].[Organization] (
    [ContactName]           NVARCHAR (50)  NULL,
    [Fax]                   NVARCHAR (50)  NULL,
    [LogoURL]               NVARCHAR (200) NULL,
    [CompanyName]           NVARCHAR (128) NULL,
    [CompanyID]             INT            NOT NULL,
    [ReceiptNo]             NVARCHAR (10)  NULL,
    [Phone]                 NVARCHAR (64)  NULL,
    [ContactFax]            NVARCHAR (20)  NULL,
    [ContactPhone]          NVARCHAR (20)  NULL,
    [ContactMobilePhone]    NVARCHAR (20)  NULL,
    [RegAddr]               NVARCHAR (256) NULL,
    [UndertakerName]        NVARCHAR (50)  NULL,
    [Addr]                  NVARCHAR (256) NULL,
    [EnglishName]           NVARCHAR (50)  NULL,
    [EnglishAddr]           NVARCHAR (256) NULL,
    [EnglishRegAddr]        NVARCHAR (256) NULL,
    [ContactEmail]          NVARCHAR (512) NULL,
    [UndertakerPhone]       NVARCHAR (20)  NULL,
    [UndertakerFax]         NVARCHAR (20)  NULL,
    [UndertakerMobilePhone] NVARCHAR (20)  NULL,
    [InvoiceSignature]      NVARCHAR (64)  NULL,
    [UndertakerID]          NVARCHAR (16)  NULL,
    [ContactTitle]          NVARCHAR (16)  NULL,
    CONSTRAINT [PK_Organization] PRIMARY KEY CLUSTERED ([CompanyID] ASC)
);


GO
PRINT N'Creating [dbo].[Payment]...';


GO
CREATE TABLE [dbo].[Payment] (
    [PaymentID]       INT            IDENTITY (1, 1) NOT NULL,
    [PayoffAmount]    INT            NULL,
    [PayoffDate]      DATETIME       NULL,
    [Status]          INT            NULL,
    [HandlerID]       INT            NULL,
    [PaymentType]     NVARCHAR (32)  NULL,
    [InvoiceID]       INT            NULL,
    [TransactionType] INT            NULL,
    [Remark]          NVARCHAR (256) NULL,
    CONSTRAINT [PK_Payment] PRIMARY KEY CLUSTERED ([PaymentID] ASC)
);


GO
PRINT N'Creating [dbo].[PaymentAudit]...';


GO
CREATE TABLE [dbo].[PaymentAudit] (
    [PaymentID] INT      NOT NULL,
    [AuditorID] INT      NULL,
    [AuditDate] DATETIME NULL,
    CONSTRAINT [PK_PaymentAudit_1] PRIMARY KEY CLUSTERED ([PaymentID] ASC)
);


GO
PRINT N'Creating [dbo].[PaymentOrder]...';


GO
CREATE TABLE [dbo].[PaymentOrder] (
    [PaymentID]    INT NOT NULL,
    [ProductID]    INT NOT NULL,
    [ProductCount] INT NOT NULL,
    CONSTRAINT [PK_PaymentOrder] PRIMARY KEY CLUSTERED ([PaymentID] ASC, [ProductID] ASC)
);


GO
PRINT N'Creating [dbo].[PaymentTransaction]...';


GO
CREATE TABLE [dbo].[PaymentTransaction] (
    [PaymentID] INT NOT NULL,
    [BranchID]  INT NOT NULL,
    CONSTRAINT [PK_PaymentTransaction] PRIMARY KEY CLUSTERED ([PaymentID] ASC)
);


GO
PRINT N'Creating [dbo].[RegisterLessonContract]...';


GO
CREATE TABLE [dbo].[RegisterLessonContract] (
    [RegisterID] INT NOT NULL,
    [ContractID] INT NOT NULL,
    CONSTRAINT [PK_RegisterLessonContract] PRIMARY KEY CLUSTERED ([RegisterID] ASC)
);


GO
PRINT N'Creating [dbo].[UniformInvoiceWinningNumber]...';


GO
CREATE TABLE [dbo].[UniformInvoiceWinningNumber] (
    [WinningID] INT           IDENTITY (1, 1) NOT NULL,
    [Year]      INT           NOT NULL,
    [Period]    INT           NOT NULL,
    [Rank]      INT           NOT NULL,
    [WinningNO] NVARCHAR (16) NOT NULL,
    [PrizeType] NVARCHAR (16) NULL,
    [Bonus]     INT           NULL,
    CONSTRAINT [PK_UniformInvoiceWinningNumber] PRIMARY KEY CLUSTERED ([WinningID] ASC)
);


GO
PRINT N'Creating [dbo].[UserSignature]...';


GO
CREATE TABLE [dbo].[UserSignature] (
    [SignatureID] INT            IDENTITY (1, 1) NOT NULL,
    [UID]         INT            NOT NULL,
    [Signature]   NVARCHAR (MAX) NULL,
    CONSTRAINT [PK_UserSignature] PRIMARY KEY CLUSTERED ([SignatureID] ASC)
);


GO
PRINT N'Creating [dbo].[VoidPayment]...';


GO
CREATE TABLE [dbo].[VoidPayment] (
    [VoidID]    INT            NOT NULL,
    [Status]    INT            NULL,
    [VoidDate]  DATETIME       NULL,
    [HandlerID] INT            NULL,
    [Remark]    NVARCHAR (256) NULL,
    [Drawback]  BIT            NULL,
    CONSTRAINT [PK_VoidPayment] PRIMARY KEY CLUSTERED ([VoidID] ASC)
);


GO
PRINT N'Creating [dbo].[VoidPaymentLevel]...';


GO
CREATE TABLE [dbo].[VoidPaymentLevel] (
    [VoidID]     INT      NOT NULL,
    [LevelDate]  DATETIME NOT NULL,
    [ExecutorID] INT      NOT NULL,
    [LevelID]    INT      NOT NULL,
    CONSTRAINT [PK_VoidPaymentLevel] PRIMARY KEY CLUSTERED ([VoidID] ASC, [LevelDate] ASC)
);


GO
PRINT N'Creating [dbo].[FK_TuitionInstallment_IntuitionCharge]...';


GO
ALTER TABLE [dbo].[TuitionInstallment] WITH NOCHECK
    ADD CONSTRAINT [FK_TuitionInstallment_IntuitionCharge] FOREIGN KEY ([RegisterID]) REFERENCES [dbo].[IntuitionCharge] ([RegisterID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_TuitionInstallment_Payment]...';


GO
ALTER TABLE [dbo].[TuitionInstallment] WITH NOCHECK
    ADD CONSTRAINT [FK_TuitionInstallment_Payment] FOREIGN KEY ([InstallmentID]) REFERENCES [dbo].[Payment] ([PaymentID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_ContractPayment_Payment]...';


GO
ALTER TABLE [dbo].[ContractPayment] WITH NOCHECK
    ADD CONSTRAINT [FK_ContractPayment_Payment] FOREIGN KEY ([PaymentID]) REFERENCES [dbo].[Payment] ([PaymentID]);


GO
PRINT N'Creating [dbo].[FK_ContractPayment_CourseContract]...';


GO
ALTER TABLE [dbo].[ContractPayment] WITH NOCHECK
    ADD CONSTRAINT [FK_ContractPayment_CourseContract] FOREIGN KEY ([ContractID]) REFERENCES [dbo].[CourseContract] ([ContractID]);


GO
PRINT N'Creating [dbo].[FK_CourseContract_LessonPriceType]...';


GO
ALTER TABLE [dbo].[CourseContract] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContract_LessonPriceType] FOREIGN KEY ([PriceID]) REFERENCES [dbo].[LessonPriceType] ([PriceID]);


GO
PRINT N'Creating [dbo].[FK_CourseContract_CourseContractType]...';


GO
ALTER TABLE [dbo].[CourseContract] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContract_CourseContractType] FOREIGN KEY ([ContractType]) REFERENCES [dbo].[CourseContractType] ([TypeID]);


GO
PRINT N'Creating [dbo].[FK_CourseContract_UserProfile]...';


GO
ALTER TABLE [dbo].[CourseContract] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContract_UserProfile] FOREIGN KEY ([OwnerID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_CourseContract_ServingCoach]...';


GO
ALTER TABLE [dbo].[CourseContract] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContract_ServingCoach] FOREIGN KEY ([FitnessConsultant]) REFERENCES [dbo].[ServingCoach] ([CoachID]);


GO
PRINT N'Creating [dbo].[FK_CourseContract_LevelExpression]...';


GO
ALTER TABLE [dbo].[CourseContract] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContract_LevelExpression] FOREIGN KEY ([Status]) REFERENCES [dbo].[LevelExpression] ([LevelID]);


GO
PRINT N'Creating [dbo].[FK_CourseContract_UserProfile1]...';


GO
ALTER TABLE [dbo].[CourseContract] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContract_UserProfile1] FOREIGN KEY ([AgentID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_CourseContractLevel_CourseContract]...';


GO
ALTER TABLE [dbo].[CourseContractLevel] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContractLevel_CourseContract] FOREIGN KEY ([ContractID]) REFERENCES [dbo].[CourseContract] ([ContractID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_CourseContractLevel_LevelExpression]...';


GO
ALTER TABLE [dbo].[CourseContractLevel] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContractLevel_LevelExpression] FOREIGN KEY ([LevelID]) REFERENCES [dbo].[LevelExpression] ([LevelID]);


GO
PRINT N'Creating [dbo].[FK_CourseContractLevel_UserProfile]...';


GO
ALTER TABLE [dbo].[CourseContractLevel] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContractLevel_UserProfile] FOREIGN KEY ([ExecutorID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_CourseContractMember_UserProfile]...';


GO
ALTER TABLE [dbo].[CourseContractMember] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContractMember_UserProfile] FOREIGN KEY ([UID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_CourseContractMember_CourseContract]...';


GO
ALTER TABLE [dbo].[CourseContractMember] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContractMember_CourseContract] FOREIGN KEY ([ContractID]) REFERENCES [dbo].[CourseContract] ([ContractID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_CourseContractRevision_CourseContract]...';


GO
ALTER TABLE [dbo].[CourseContractRevision] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContractRevision_CourseContract] FOREIGN KEY ([RevisionID]) REFERENCES [dbo].[CourseContract] ([ContractID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_CourseContractRevision_CourseContract1]...';


GO
ALTER TABLE [dbo].[CourseContractRevision] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContractRevision_CourseContract1] FOREIGN KEY ([OriginalContract]) REFERENCES [dbo].[CourseContract] ([ContractID]);


GO
PRINT N'Creating [dbo].[FK_CourseContractSignature_CourseContractMember]...';


GO
ALTER TABLE [dbo].[CourseContractSignature] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContractSignature_CourseContractMember] FOREIGN KEY ([ContractID], [UID]) REFERENCES [dbo].[CourseContractMember] ([ContractID], [UID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_CourseContractType_GroupingLessonDiscount]...';


GO
ALTER TABLE [dbo].[CourseContractType] WITH NOCHECK
    ADD CONSTRAINT [FK_CourseContractType_GroupingLessonDiscount] FOREIGN KEY ([GroupingMemberCount]) REFERENCES [dbo].[GroupingLessonDiscount] ([GroupingMemberCount]);


GO
PRINT N'Creating [dbo].[FK_DerivedDocument_Document]...';


GO
ALTER TABLE [dbo].[DerivedDocument] WITH NOCHECK
    ADD CONSTRAINT [FK_DerivedDocument_Document] FOREIGN KEY ([DocID]) REFERENCES [dbo].[Document] ([DocID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_DerivedDocument_Document1]...';


GO
ALTER TABLE [dbo].[DerivedDocument] WITH NOCHECK
    ADD CONSTRAINT [FK_DerivedDocument_Document1] FOREIGN KEY ([SourceID]) REFERENCES [dbo].[Document] ([DocID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAllowance_Document]...';


GO
ALTER TABLE [dbo].[InvoiceAllowance] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAllowance_Document] FOREIGN KEY ([AllowanceID]) REFERENCES [dbo].[Document] ([DocID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAllowanceBuyer_InvoiceAllowance]...';


GO
ALTER TABLE [dbo].[InvoiceAllowanceBuyer] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAllowanceBuyer_InvoiceAllowance] FOREIGN KEY ([AllowanceID]) REFERENCES [dbo].[InvoiceAllowance] ([AllowanceID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAllowanceBuyer_Organization]...';


GO
ALTER TABLE [dbo].[InvoiceAllowanceBuyer] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAllowanceBuyer_Organization] FOREIGN KEY ([BuyerID]) REFERENCES [dbo].[Organization] ([CompanyID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAllowanceCancellation_InvoiceAllowance]...';


GO
ALTER TABLE [dbo].[InvoiceAllowanceCancellation] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAllowanceCancellation_InvoiceAllowance] FOREIGN KEY ([AllowanceID]) REFERENCES [dbo].[InvoiceAllowance] ([AllowanceID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAllowanceDetails_InvoiceAllowance]...';


GO
ALTER TABLE [dbo].[InvoiceAllowanceDetails] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAllowanceDetails_InvoiceAllowance] FOREIGN KEY ([AllowanceID]) REFERENCES [dbo].[InvoiceAllowance] ([AllowanceID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAllowanceDetails_InvoiceAllowanceItem]...';


GO
ALTER TABLE [dbo].[InvoiceAllowanceDetails] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAllowanceDetails_InvoiceAllowanceItem] FOREIGN KEY ([ItemID]) REFERENCES [dbo].[InvoiceAllowanceItem] ([ItemID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAllowanceItem_InvoiceProductItem]...';


GO
ALTER TABLE [dbo].[InvoiceAllowanceItem] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAllowanceItem_InvoiceProductItem] FOREIGN KEY ([ProductItemID]) REFERENCES [dbo].[InvoiceProductItem] ([ItemID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAllowanceSeller_InvoiceAllowance]...';


GO
ALTER TABLE [dbo].[InvoiceAllowanceSeller] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAllowanceSeller_InvoiceAllowance] FOREIGN KEY ([AllowanceID]) REFERENCES [dbo].[InvoiceAllowance] ([AllowanceID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAllowanceSeller_Organization]...';


GO
ALTER TABLE [dbo].[InvoiceAllowanceSeller] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAllowanceSeller_Organization] FOREIGN KEY ([SellerID]) REFERENCES [dbo].[Organization] ([CompanyID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceAmountType_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoiceAmountType] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceAmountType_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceBuyer_Organization]...';


GO
ALTER TABLE [dbo].[InvoiceBuyer] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceBuyer_Organization] FOREIGN KEY ([BuyerID]) REFERENCES [dbo].[Organization] ([CompanyID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceBuyer_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoiceBuyer] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceBuyer_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceCancellation_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoiceCancellation] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceCancellation_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceCarrier_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoiceCarrier] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceCarrier_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceDetails_InvoiceProduct]...';


GO
ALTER TABLE [dbo].[InvoiceDetails] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceDetails_InvoiceProduct] FOREIGN KEY ([ProductID]) REFERENCES [dbo].[InvoiceProduct] ([ProductID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceDetails_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoiceDetails] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceDetails_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceDonation_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoiceDonation] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceDonation_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceItem_Organization]...';


GO
ALTER TABLE [dbo].[InvoiceItem] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceItem_Organization] FOREIGN KEY ([SellerID]) REFERENCES [dbo].[Organization] ([CompanyID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceItem_Document]...';


GO
ALTER TABLE [dbo].[InvoiceItem] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceItem_Document] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[Document] ([DocID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceNoAssignment_InvoiceNoInterval]...';


GO
ALTER TABLE [dbo].[InvoiceNoAssignment] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceNoAssignment_InvoiceNoInterval] FOREIGN KEY ([IntervalID]) REFERENCES [dbo].[InvoiceNoInterval] ([IntervalID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceNoAssignment_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoiceNoAssignment] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceNoAssignment_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceNoInterval_InvoiceTrackCodeAssignment]...';


GO
ALTER TABLE [dbo].[InvoiceNoInterval] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceNoInterval_InvoiceTrackCodeAssignment] FOREIGN KEY ([TrackID], [SellerID]) REFERENCES [dbo].[InvoiceTrackCodeAssignment] ([TrackID], [SellerID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceProductItem_InvoiceProduct]...';


GO
ALTER TABLE [dbo].[InvoiceProductItem] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceProductItem_InvoiceProduct] FOREIGN KEY ([ProductID]) REFERENCES [dbo].[InvoiceProduct] ([ProductID]);


GO
PRINT N'Creating [dbo].[FK_InvoicePurchaseOrder_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoicePurchaseOrder] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoicePurchaseOrder_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceSeller_Organization]...';


GO
ALTER TABLE [dbo].[InvoiceSeller] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceSeller_Organization] FOREIGN KEY ([SellerID]) REFERENCES [dbo].[Organization] ([CompanyID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceSeller_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoiceSeller] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceSeller_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_InvoiceTrackCodeAssignment_InvoiceTrackCode]...';


GO
ALTER TABLE [dbo].[InvoiceTrackCodeAssignment] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceTrackCodeAssignment_InvoiceTrackCode] FOREIGN KEY ([TrackID]) REFERENCES [dbo].[InvoiceTrackCode] ([TrackID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceTrackCodeAssignment_Organization]...';


GO
ALTER TABLE [dbo].[InvoiceTrackCodeAssignment] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceTrackCodeAssignment_Organization] FOREIGN KEY ([SellerID]) REFERENCES [dbo].[Organization] ([CompanyID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceWinningNumber_UniformInvoiceWinningNumber]...';


GO
ALTER TABLE [dbo].[InvoiceWinningNumber] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceWinningNumber_UniformInvoiceWinningNumber] FOREIGN KEY ([WinningID]) REFERENCES [dbo].[UniformInvoiceWinningNumber] ([WinningID]);


GO
PRINT N'Creating [dbo].[FK_InvoiceWinningNumber_InvoiceItem]...';


GO
ALTER TABLE [dbo].[InvoiceWinningNumber] WITH NOCHECK
    ADD CONSTRAINT [FK_InvoiceWinningNumber_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_LessonPriceProperty_LevelExpression]...';


GO
ALTER TABLE [dbo].[LessonPriceProperty] WITH NOCHECK
    ADD CONSTRAINT [FK_LessonPriceProperty_LevelExpression] FOREIGN KEY ([PropertyID]) REFERENCES [dbo].[LevelExpression] ([LevelID]);


GO
PRINT N'Creating [dbo].[FK_LessonPriceProperty_LessonPriceType]...';


GO
ALTER TABLE [dbo].[LessonPriceProperty] WITH NOCHECK
    ADD CONSTRAINT [FK_LessonPriceProperty_LessonPriceType] FOREIGN KEY ([PriceID]) REFERENCES [dbo].[LessonPriceType] ([PriceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_LessonPriceSeries_LevelExpression]...';


GO
ALTER TABLE [dbo].[LessonPriceSeries] WITH NOCHECK
    ADD CONSTRAINT [FK_LessonPriceSeries_LevelExpression] FOREIGN KEY ([Status]) REFERENCES [dbo].[LevelExpression] ([LevelID]);


GO
PRINT N'Creating [dbo].[FK_LessonPriceSeries_LessonPriceType]...';


GO
ALTER TABLE [dbo].[LessonPriceSeries] WITH NOCHECK
    ADD CONSTRAINT [FK_LessonPriceSeries_LessonPriceType] FOREIGN KEY ([PriceID]) REFERENCES [dbo].[LessonPriceType] ([PriceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_MerchandiseTransaction_MerchandiseTransactionType]...';


GO
ALTER TABLE [dbo].[MerchandiseTransaction] WITH NOCHECK
    ADD CONSTRAINT [FK_MerchandiseTransaction_MerchandiseTransactionType] FOREIGN KEY ([TransactionID]) REFERENCES [dbo].[MerchandiseTransactionType] ([TransactionID]);


GO
PRINT N'Creating [dbo].[FK_MerchandiseTransaction_MerchandiseWindow]...';


GO
ALTER TABLE [dbo].[MerchandiseTransaction] WITH NOCHECK
    ADD CONSTRAINT [FK_MerchandiseTransaction_MerchandiseWindow] FOREIGN KEY ([ProductID]) REFERENCES [dbo].[MerchandiseWindow] ([ProductID]);


GO
PRINT N'Creating [dbo].[FK_MerchandiseWindow_LevelExpression]...';


GO
ALTER TABLE [dbo].[MerchandiseWindow] WITH NOCHECK
    ADD CONSTRAINT [FK_MerchandiseWindow_LevelExpression] FOREIGN KEY ([Status]) REFERENCES [dbo].[LevelExpression] ([LevelID]);


GO
PRINT N'Creating [dbo].[FK_Payment_UserProfile]...';


GO
ALTER TABLE [dbo].[Payment] WITH NOCHECK
    ADD CONSTRAINT [FK_Payment_UserProfile] FOREIGN KEY ([HandlerID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_Payment_LevelExpression]...';


GO
ALTER TABLE [dbo].[Payment] WITH NOCHECK
    ADD CONSTRAINT [FK_Payment_LevelExpression] FOREIGN KEY ([Status]) REFERENCES [dbo].[LevelExpression] ([LevelID]);


GO
PRINT N'Creating [dbo].[FK_Payment_InvoiceItem]...';


GO
ALTER TABLE [dbo].[Payment] WITH NOCHECK
    ADD CONSTRAINT [FK_Payment_InvoiceItem] FOREIGN KEY ([InvoiceID]) REFERENCES [dbo].[InvoiceItem] ([InvoiceID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_PaymentAudit_Payment]...';


GO
ALTER TABLE [dbo].[PaymentAudit] WITH NOCHECK
    ADD CONSTRAINT [FK_PaymentAudit_Payment] FOREIGN KEY ([PaymentID]) REFERENCES [dbo].[Payment] ([PaymentID]);


GO
PRINT N'Creating [dbo].[FK_PaymentAudit_UserProfile]...';


GO
ALTER TABLE [dbo].[PaymentAudit] WITH NOCHECK
    ADD CONSTRAINT [FK_PaymentAudit_UserProfile] FOREIGN KEY ([AuditorID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_PaymentOrder_PaymentTransaction]...';


GO
ALTER TABLE [dbo].[PaymentOrder] WITH NOCHECK
    ADD CONSTRAINT [FK_PaymentOrder_PaymentTransaction] FOREIGN KEY ([PaymentID]) REFERENCES [dbo].[PaymentTransaction] ([PaymentID]);


GO
PRINT N'Creating [dbo].[FK_PaymentOrder_MerchandiseWindow]...';


GO
ALTER TABLE [dbo].[PaymentOrder] WITH NOCHECK
    ADD CONSTRAINT [FK_PaymentOrder_MerchandiseWindow] FOREIGN KEY ([ProductID]) REFERENCES [dbo].[MerchandiseWindow] ([ProductID]);


GO
PRINT N'Creating [dbo].[FK_PaymentTransaction_Payment]...';


GO
ALTER TABLE [dbo].[PaymentTransaction] WITH NOCHECK
    ADD CONSTRAINT [FK_PaymentTransaction_Payment] FOREIGN KEY ([PaymentID]) REFERENCES [dbo].[Payment] ([PaymentID]);


GO
PRINT N'Creating [dbo].[FK_PaymentTransaction_BranchStore]...';


GO
ALTER TABLE [dbo].[PaymentTransaction] WITH NOCHECK
    ADD CONSTRAINT [FK_PaymentTransaction_BranchStore] FOREIGN KEY ([BranchID]) REFERENCES [dbo].[BranchStore] ([BranchID]);


GO
PRINT N'Creating [dbo].[FK_RegisterLessonContract_CourseContract]...';


GO
ALTER TABLE [dbo].[RegisterLessonContract] WITH NOCHECK
    ADD CONSTRAINT [FK_RegisterLessonContract_CourseContract] FOREIGN KEY ([ContractID]) REFERENCES [dbo].[CourseContract] ([ContractID]);


GO
PRINT N'Creating [dbo].[FK_RegisterLessonContract_RegisterLesson]...';


GO
ALTER TABLE [dbo].[RegisterLessonContract] WITH NOCHECK
    ADD CONSTRAINT [FK_RegisterLessonContract_RegisterLesson] FOREIGN KEY ([RegisterID]) REFERENCES [dbo].[RegisterLesson] ([RegisterID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_UserSignature_UserProfile]...';


GO
ALTER TABLE [dbo].[UserSignature] WITH NOCHECK
    ADD CONSTRAINT [FK_UserSignature_UserProfile] FOREIGN KEY ([UID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_VoidPayment_Payment]...';


GO
ALTER TABLE [dbo].[VoidPayment] WITH NOCHECK
    ADD CONSTRAINT [FK_VoidPayment_Payment] FOREIGN KEY ([VoidID]) REFERENCES [dbo].[Payment] ([PaymentID]);


GO
PRINT N'Creating [dbo].[FK_VoidPayment_UserProfile]...';


GO
ALTER TABLE [dbo].[VoidPayment] WITH NOCHECK
    ADD CONSTRAINT [FK_VoidPayment_UserProfile] FOREIGN KEY ([HandlerID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_VoidPayment_LevelExpression]...';


GO
ALTER TABLE [dbo].[VoidPayment] WITH NOCHECK
    ADD CONSTRAINT [FK_VoidPayment_LevelExpression] FOREIGN KEY ([Status]) REFERENCES [dbo].[LevelExpression] ([LevelID]);


GO
PRINT N'Creating [dbo].[FK_VoidPaymentLevel_LevelExpression]...';


GO
ALTER TABLE [dbo].[VoidPaymentLevel] WITH NOCHECK
    ADD CONSTRAINT [FK_VoidPaymentLevel_LevelExpression] FOREIGN KEY ([LevelID]) REFERENCES [dbo].[LevelExpression] ([LevelID]);


GO
PRINT N'Creating [dbo].[FK_VoidPaymentLevel_UserProfile]...';


GO
ALTER TABLE [dbo].[VoidPaymentLevel] WITH NOCHECK
    ADD CONSTRAINT [FK_VoidPaymentLevel_UserProfile] FOREIGN KEY ([ExecutorID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_VoidPaymentLevel_VoidPayment]...';


GO
ALTER TABLE [dbo].[VoidPaymentLevel] WITH NOCHECK
    ADD CONSTRAINT [FK_VoidPaymentLevel_VoidPayment] FOREIGN KEY ([VoidID]) REFERENCES [dbo].[VoidPayment] ([VoidID]) ON DELETE CASCADE;


GO
PRINT N'Creating [dbo].[FK_BranchStore_Organization]...';


GO
ALTER TABLE [dbo].[BranchStore] WITH NOCHECK
    ADD CONSTRAINT [FK_BranchStore_Organization] FOREIGN KEY ([BranchID]) REFERENCES [dbo].[Organization] ([CompanyID]);


GO
PRINT N'Creating [dbo].[FK_BranchStore_UserProfile]...';


GO
ALTER TABLE [dbo].[BranchStore] WITH NOCHECK
    ADD CONSTRAINT [FK_BranchStore_UserProfile] FOREIGN KEY ([ManagerID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_BranchStore_UserProfile1]...';


GO
ALTER TABLE [dbo].[BranchStore] WITH NOCHECK
    ADD CONSTRAINT [FK_BranchStore_UserProfile1] FOREIGN KEY ([ViceManagerID]) REFERENCES [dbo].[UserProfile] ([UID]);


GO
PRINT N'Creating [dbo].[FK_LessonPriceType_BranchStore]...';


GO
ALTER TABLE [dbo].[LessonPriceType] WITH NOCHECK
    ADD CONSTRAINT [FK_LessonPriceType_BranchStore] FOREIGN KEY ([BranchID]) REFERENCES [dbo].[BranchStore] ([BranchID]);


GO
PRINT N'Creating [dbo].[FK_LessonPriceType_LessonPriceSeries]...';


GO
ALTER TABLE [dbo].[LessonPriceType] WITH NOCHECK
    ADD CONSTRAINT [FK_LessonPriceType_LessonPriceSeries] FOREIGN KEY ([SeriesID]) REFERENCES [dbo].[LessonPriceSeries] ([PriceID]);


GO
PRINT N'Creating [dbo].[FK_TuitionAchievement_Payment]...';


GO
ALTER TABLE [dbo].[TuitionAchievement] WITH NOCHECK
    ADD CONSTRAINT [FK_TuitionAchievement_Payment] FOREIGN KEY ([InstallmentID]) REFERENCES [dbo].[Payment] ([PaymentID]);


GO
PRINT N'Refreshing [dbo].[V_LearnerFitenessAssessment]...';


GO
EXECUTE sp_refreshsqlmodule N'[dbo].[V_LearnerFitenessAssessment]';


GO
PRINT N'Creating [dbo].[InvoiceAllowance].[AllowanceNumber].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'折讓證明單號碼', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAllowance', @level2type = N'COLUMN', @level2name = N'AllowanceNumber';


GO
PRINT N'Creating [dbo].[InvoiceAllowance].[AllowanceType].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'折讓種類
1:買方開立折讓證明單
2:賣方折讓證明單通知
', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAllowance', @level2type = N'COLUMN', @level2name = N'AllowanceType';


GO
PRINT N'Creating [dbo].[InvoiceAllowance].[AllowanceDate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'折讓證明單日期', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAllowance', @level2type = N'COLUMN', @level2name = N'AllowanceDate';


GO
PRINT N'Creating [dbo].[InvoiceAllowance].[TotalAmount].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'金額(不含稅之進貨額)合計', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAllowance', @level2type = N'COLUMN', @level2name = N'TotalAmount';


GO
PRINT N'Creating [dbo].[InvoiceAllowance].[TaxAmount].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'營業稅額合計', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAllowance', @level2type = N'COLUMN', @level2name = N'TaxAmount';


GO
PRINT N'Creating [dbo].[InvoiceAllowanceCancellation].[CancelDate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'作廢日期', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAllowanceCancellation', @level2type = N'COLUMN', @level2name = N'CancelDate';


GO
PRINT N'Creating [dbo].[InvoiceAllowanceCancellation].[Remark].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'作廢折讓備註
作廢折讓時必填，填寫作廢原因', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAllowanceCancellation', @level2type = N'COLUMN', @level2name = N'Remark';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[TaxType].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'課稅別
1：應稅
2：零稅率
3：免稅
9：混合應稅與免稅或零稅率 (限收銀機發票無法分辨時使用)', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'TaxType';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[SalesAmount].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'應稅銷售額合計(新台幣)', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'SalesAmount';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[TaxAmount].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'營業稅額', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'TaxAmount';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[TaxRate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'稅率', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'TaxRate';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[TotalAmount].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'總計
整數
(應稅銷售額合計+免稅銷售額合計+零稅率銷售額合計+營業稅額=此總計欄位) ，可為負數', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'TotalAmount';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[TotalAmountInChinese].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'中文國字大寫金額', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'TotalAmountInChinese';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[DiscountAmount].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'扣抵金額', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'DiscountAmount';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[Adjustment].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'角分調整', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'Adjustment';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[OriginalCurrencyAmount].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'原幣金額', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'OriginalCurrencyAmount';


GO
PRINT N'Creating [dbo].[InvoiceAmountType].[ExchangeRate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'匯率', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceAmountType', @level2type = N'COLUMN', @level2name = N'ExchangeRate';


GO
PRINT N'Creating [dbo].[InvoiceCancellation].[CancellationNo].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'作廢發票號碼', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceCancellation', @level2type = N'COLUMN', @level2name = N'CancellationNo';


GO
PRINT N'Creating [dbo].[InvoiceCancellation].[CancelDate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'作廢日期', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceCancellation', @level2type = N'COLUMN', @level2name = N'CancelDate';


GO
PRINT N'Creating [dbo].[InvoiceCancellation].[ReturnTaxDocumentNo].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'專案作廢核准文號
若發票的作廢時間超過申報期間，則此欄位為必填欄位。若不填寫由上傳營業人自行負責。', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceCancellation', @level2type = N'COLUMN', @level2name = N'ReturnTaxDocumentNo';


GO
PRINT N'Creating [dbo].[InvoiceCancellation].[Remark].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'作廢備註
作廢發票時必填，填寫作廢原因', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceCancellation', @level2type = N'COLUMN', @level2name = N'Remark';


GO
PRINT N'Creating [dbo].[InvoiceCarrier].[InvoiceID].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Primary Key', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceCarrier', @level2type = N'COLUMN', @level2name = N'InvoiceID';


GO
PRINT N'Creating [dbo].[InvoiceCarrier].[CarrierType].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'載具類別
1：悠遊卡
2：UXB2B條碼卡', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceCarrier', @level2type = N'COLUMN', @level2name = N'CarrierType';


GO
PRINT N'Creating [dbo].[InvoiceCarrier].[CarrierNo].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'載具卡號', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceCarrier', @level2type = N'COLUMN', @level2name = N'CarrierNo';


GO
PRINT N'Creating [dbo].[InvoiceDonation].[InvoiceID].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Primary Key', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceDonation', @level2type = N'COLUMN', @level2name = N'InvoiceID';


GO
PRINT N'Creating [dbo].[InvoiceDonation].[AgencyCode].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'機構代碼', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceDonation', @level2type = N'COLUMN', @level2name = N'AgencyCode';


GO
PRINT N'Creating [dbo].[InvoiceItem].[InvoiceID].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Primary Key', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'InvoiceID';


GO
PRINT N'Creating [dbo].[InvoiceItem].[No].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'發票號碼', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'No';


GO
PRINT N'Creating [dbo].[InvoiceItem].[InvoiceDate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'發票日期', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'InvoiceDate';


GO
PRINT N'Creating [dbo].[InvoiceItem].[CheckNo].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'發票檢查碼', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'CheckNo';


GO
PRINT N'Creating [dbo].[InvoiceItem].[Remark].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'總備註', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'Remark';


GO
PRINT N'Creating [dbo].[InvoiceItem].[BuyerRemark].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'買受人註記欄
1：得抵扣之進貨及費用；
2：得抵扣之固定資產；
3：不得抵扣之進貨及費用；
4：不得抵扣之固定資產
', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'BuyerRemark';


GO
PRINT N'Creating [dbo].[InvoiceItem].[CustomsClearanceMark].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'通關方式註記
1：非經海關出口;
2：經海關出口(零稅率時，為必要欄位)
', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'CustomsClearanceMark';


GO
PRINT N'Creating [dbo].[InvoiceItem].[TaxCenter].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'稅捐稽徵處名稱', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'TaxCenter';


GO
PRINT N'Creating [dbo].[InvoiceItem].[PermitDate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'核准日', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'PermitDate';


GO
PRINT N'Creating [dbo].[InvoiceItem].[PermitWord].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'核准文', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'PermitWord';


GO
PRINT N'Creating [dbo].[InvoiceItem].[PermitNumber].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'核准號', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'PermitNumber';


GO
PRINT N'Creating [dbo].[InvoiceItem].[Category].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'沖帳別', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'Category';


GO
PRINT N'Creating [dbo].[InvoiceItem].[RelateNumber].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'相關號碼', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'RelateNumber';


GO
PRINT N'Creating [dbo].[InvoiceItem].[InvoiceType].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'發票類別
1: 三聯式;
2: 二聯式;
3: 二聯式收銀機;
4. 特種稅額;
5: 電子計算機;
6: 三聯式收銀機
', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'InvoiceType';


GO
PRINT N'Creating [dbo].[InvoiceItem].[GroupMark].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'彙開註記
以”*”表示 彙開', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'GroupMark';


GO
PRINT N'Creating [dbo].[InvoiceItem].[DonateMark].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'捐贈註記
以”0”表示 非捐贈發票
以”1”表示 為捐贈發票
', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'DonateMark';


GO
PRINT N'Creating [dbo].[InvoiceItem].[RandomNo].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'發票防偽隨機碼
前端隨機產生', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceItem', @level2type = N'COLUMN', @level2name = N'RandomNo';


GO
PRINT N'Creating [dbo].[InvoiceWinningNumber].[WinningNO].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'中獎號碼', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'InvoiceWinningNumber', @level2type = N'COLUMN', @level2name = N'WinningNO';


GO
PRINT N'Creating [dbo].[Organization].[ContactName].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'連絡人', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'ContactName';


GO
PRINT N'Creating [dbo].[Organization].[Fax].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'傳真', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'Fax';


GO
PRINT N'Creating [dbo].[Organization].[CompanyName].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'機關名稱', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'CompanyName';


GO
PRINT N'Creating [dbo].[Organization].[CompanyID].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'主鍵', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'CompanyID';


GO
PRINT N'Creating [dbo].[Organization].[ReceiptNo].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'統一編號', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'ReceiptNo';


GO
PRINT N'Creating [dbo].[Organization].[Phone].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'電話', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'Phone';


GO
PRINT N'Creating [dbo].[Organization].[UndertakerName].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'負責人姓名', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'UndertakerName';


GO
PRINT N'Creating [dbo].[Organization].[Addr].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'地址', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'Addr';


GO
PRINT N'Creating [dbo].[Organization].[ContactEmail].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'連絡人電子郵件', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'ContactEmail';


GO
PRINT N'Creating [dbo].[Organization].[ContactTitle].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'連絡人職稱', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Organization', @level2type = N'COLUMN', @level2name = N'ContactTitle';


GO
PRINT N'Creating [dbo].[Payment].[InvoiceID].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Primary Key', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'Payment', @level2type = N'COLUMN', @level2name = N'InvoiceID';


GO
PRINT N'Checking existing data against newly created constraints';


GO
--USE [$(DatabaseName)];


GO
ALTER TABLE [dbo].[TuitionInstallment] WITH CHECK CHECK CONSTRAINT [FK_TuitionInstallment_IntuitionCharge];

ALTER TABLE [dbo].[TuitionInstallment] WITH CHECK CHECK CONSTRAINT [FK_TuitionInstallment_Payment];

ALTER TABLE [dbo].[ContractPayment] WITH CHECK CHECK CONSTRAINT [FK_ContractPayment_Payment];

ALTER TABLE [dbo].[ContractPayment] WITH CHECK CHECK CONSTRAINT [FK_ContractPayment_CourseContract];

ALTER TABLE [dbo].[CourseContract] WITH CHECK CHECK CONSTRAINT [FK_CourseContract_LessonPriceType];

ALTER TABLE [dbo].[CourseContract] WITH CHECK CHECK CONSTRAINT [FK_CourseContract_CourseContractType];

ALTER TABLE [dbo].[CourseContract] WITH CHECK CHECK CONSTRAINT [FK_CourseContract_UserProfile];

ALTER TABLE [dbo].[CourseContract] WITH CHECK CHECK CONSTRAINT [FK_CourseContract_ServingCoach];

ALTER TABLE [dbo].[CourseContract] WITH CHECK CHECK CONSTRAINT [FK_CourseContract_LevelExpression];

ALTER TABLE [dbo].[CourseContract] WITH CHECK CHECK CONSTRAINT [FK_CourseContract_UserProfile1];

ALTER TABLE [dbo].[CourseContractLevel] WITH CHECK CHECK CONSTRAINT [FK_CourseContractLevel_CourseContract];

ALTER TABLE [dbo].[CourseContractLevel] WITH CHECK CHECK CONSTRAINT [FK_CourseContractLevel_LevelExpression];

ALTER TABLE [dbo].[CourseContractLevel] WITH CHECK CHECK CONSTRAINT [FK_CourseContractLevel_UserProfile];

ALTER TABLE [dbo].[CourseContractMember] WITH CHECK CHECK CONSTRAINT [FK_CourseContractMember_UserProfile];

ALTER TABLE [dbo].[CourseContractMember] WITH CHECK CHECK CONSTRAINT [FK_CourseContractMember_CourseContract];

ALTER TABLE [dbo].[CourseContractRevision] WITH CHECK CHECK CONSTRAINT [FK_CourseContractRevision_CourseContract];

ALTER TABLE [dbo].[CourseContractRevision] WITH CHECK CHECK CONSTRAINT [FK_CourseContractRevision_CourseContract1];

ALTER TABLE [dbo].[CourseContractSignature] WITH CHECK CHECK CONSTRAINT [FK_CourseContractSignature_CourseContractMember];

ALTER TABLE [dbo].[CourseContractType] WITH CHECK CHECK CONSTRAINT [FK_CourseContractType_GroupingLessonDiscount];

ALTER TABLE [dbo].[DerivedDocument] WITH CHECK CHECK CONSTRAINT [FK_DerivedDocument_Document];

ALTER TABLE [dbo].[DerivedDocument] WITH CHECK CHECK CONSTRAINT [FK_DerivedDocument_Document1];

ALTER TABLE [dbo].[InvoiceAllowance] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAllowance_Document];

ALTER TABLE [dbo].[InvoiceAllowanceBuyer] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAllowanceBuyer_InvoiceAllowance];

ALTER TABLE [dbo].[InvoiceAllowanceBuyer] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAllowanceBuyer_Organization];

ALTER TABLE [dbo].[InvoiceAllowanceCancellation] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAllowanceCancellation_InvoiceAllowance];

ALTER TABLE [dbo].[InvoiceAllowanceDetails] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAllowanceDetails_InvoiceAllowance];

ALTER TABLE [dbo].[InvoiceAllowanceDetails] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAllowanceDetails_InvoiceAllowanceItem];

ALTER TABLE [dbo].[InvoiceAllowanceItem] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAllowanceItem_InvoiceProductItem];

ALTER TABLE [dbo].[InvoiceAllowanceSeller] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAllowanceSeller_InvoiceAllowance];

ALTER TABLE [dbo].[InvoiceAllowanceSeller] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAllowanceSeller_Organization];

ALTER TABLE [dbo].[InvoiceAmountType] WITH CHECK CHECK CONSTRAINT [FK_InvoiceAmountType_InvoiceItem];

ALTER TABLE [dbo].[InvoiceBuyer] WITH CHECK CHECK CONSTRAINT [FK_InvoiceBuyer_Organization];

ALTER TABLE [dbo].[InvoiceBuyer] WITH CHECK CHECK CONSTRAINT [FK_InvoiceBuyer_InvoiceItem];

ALTER TABLE [dbo].[InvoiceCancellation] WITH CHECK CHECK CONSTRAINT [FK_InvoiceCancellation_InvoiceItem];

ALTER TABLE [dbo].[InvoiceCarrier] WITH CHECK CHECK CONSTRAINT [FK_InvoiceCarrier_InvoiceItem];

ALTER TABLE [dbo].[InvoiceDetails] WITH CHECK CHECK CONSTRAINT [FK_InvoiceDetails_InvoiceProduct];

ALTER TABLE [dbo].[InvoiceDetails] WITH CHECK CHECK CONSTRAINT [FK_InvoiceDetails_InvoiceItem];

ALTER TABLE [dbo].[InvoiceDonation] WITH CHECK CHECK CONSTRAINT [FK_InvoiceDonation_InvoiceItem];

ALTER TABLE [dbo].[InvoiceItem] WITH CHECK CHECK CONSTRAINT [FK_InvoiceItem_Organization];

ALTER TABLE [dbo].[InvoiceItem] WITH CHECK CHECK CONSTRAINT [FK_InvoiceItem_Document];

ALTER TABLE [dbo].[InvoiceNoAssignment] WITH CHECK CHECK CONSTRAINT [FK_InvoiceNoAssignment_InvoiceNoInterval];

ALTER TABLE [dbo].[InvoiceNoAssignment] WITH CHECK CHECK CONSTRAINT [FK_InvoiceNoAssignment_InvoiceItem];

ALTER TABLE [dbo].[InvoiceNoInterval] WITH CHECK CHECK CONSTRAINT [FK_InvoiceNoInterval_InvoiceTrackCodeAssignment];

ALTER TABLE [dbo].[InvoiceProductItem] WITH CHECK CHECK CONSTRAINT [FK_InvoiceProductItem_InvoiceProduct];

ALTER TABLE [dbo].[InvoicePurchaseOrder] WITH CHECK CHECK CONSTRAINT [FK_InvoicePurchaseOrder_InvoiceItem];

ALTER TABLE [dbo].[InvoiceSeller] WITH CHECK CHECK CONSTRAINT [FK_InvoiceSeller_Organization];

ALTER TABLE [dbo].[InvoiceSeller] WITH CHECK CHECK CONSTRAINT [FK_InvoiceSeller_InvoiceItem];

ALTER TABLE [dbo].[InvoiceTrackCodeAssignment] WITH CHECK CHECK CONSTRAINT [FK_InvoiceTrackCodeAssignment_InvoiceTrackCode];

ALTER TABLE [dbo].[InvoiceTrackCodeAssignment] WITH CHECK CHECK CONSTRAINT [FK_InvoiceTrackCodeAssignment_Organization];

ALTER TABLE [dbo].[InvoiceWinningNumber] WITH CHECK CHECK CONSTRAINT [FK_InvoiceWinningNumber_UniformInvoiceWinningNumber];

ALTER TABLE [dbo].[InvoiceWinningNumber] WITH CHECK CHECK CONSTRAINT [FK_InvoiceWinningNumber_InvoiceItem];

ALTER TABLE [dbo].[LessonPriceProperty] WITH CHECK CHECK CONSTRAINT [FK_LessonPriceProperty_LevelExpression];

ALTER TABLE [dbo].[LessonPriceProperty] WITH CHECK CHECK CONSTRAINT [FK_LessonPriceProperty_LessonPriceType];

ALTER TABLE [dbo].[LessonPriceSeries] WITH CHECK CHECK CONSTRAINT [FK_LessonPriceSeries_LevelExpression];

ALTER TABLE [dbo].[LessonPriceSeries] WITH CHECK CHECK CONSTRAINT [FK_LessonPriceSeries_LessonPriceType];

ALTER TABLE [dbo].[MerchandiseTransaction] WITH CHECK CHECK CONSTRAINT [FK_MerchandiseTransaction_MerchandiseTransactionType];

ALTER TABLE [dbo].[MerchandiseTransaction] WITH CHECK CHECK CONSTRAINT [FK_MerchandiseTransaction_MerchandiseWindow];

ALTER TABLE [dbo].[MerchandiseWindow] WITH CHECK CHECK CONSTRAINT [FK_MerchandiseWindow_LevelExpression];

ALTER TABLE [dbo].[Payment] WITH CHECK CHECK CONSTRAINT [FK_Payment_UserProfile];

ALTER TABLE [dbo].[Payment] WITH CHECK CHECK CONSTRAINT [FK_Payment_LevelExpression];

ALTER TABLE [dbo].[Payment] WITH CHECK CHECK CONSTRAINT [FK_Payment_InvoiceItem];

ALTER TABLE [dbo].[PaymentAudit] WITH CHECK CHECK CONSTRAINT [FK_PaymentAudit_Payment];

ALTER TABLE [dbo].[PaymentAudit] WITH CHECK CHECK CONSTRAINT [FK_PaymentAudit_UserProfile];

ALTER TABLE [dbo].[PaymentOrder] WITH CHECK CHECK CONSTRAINT [FK_PaymentOrder_PaymentTransaction];

ALTER TABLE [dbo].[PaymentOrder] WITH CHECK CHECK CONSTRAINT [FK_PaymentOrder_MerchandiseWindow];

ALTER TABLE [dbo].[PaymentTransaction] WITH CHECK CHECK CONSTRAINT [FK_PaymentTransaction_Payment];

ALTER TABLE [dbo].[PaymentTransaction] WITH CHECK CHECK CONSTRAINT [FK_PaymentTransaction_BranchStore];

ALTER TABLE [dbo].[RegisterLessonContract] WITH CHECK CHECK CONSTRAINT [FK_RegisterLessonContract_CourseContract];

ALTER TABLE [dbo].[RegisterLessonContract] WITH CHECK CHECK CONSTRAINT [FK_RegisterLessonContract_RegisterLesson];

ALTER TABLE [dbo].[UserSignature] WITH CHECK CHECK CONSTRAINT [FK_UserSignature_UserProfile];

ALTER TABLE [dbo].[VoidPayment] WITH CHECK CHECK CONSTRAINT [FK_VoidPayment_Payment];

ALTER TABLE [dbo].[VoidPayment] WITH CHECK CHECK CONSTRAINT [FK_VoidPayment_UserProfile];

ALTER TABLE [dbo].[VoidPayment] WITH CHECK CHECK CONSTRAINT [FK_VoidPayment_LevelExpression];

ALTER TABLE [dbo].[VoidPaymentLevel] WITH CHECK CHECK CONSTRAINT [FK_VoidPaymentLevel_LevelExpression];

ALTER TABLE [dbo].[VoidPaymentLevel] WITH CHECK CHECK CONSTRAINT [FK_VoidPaymentLevel_UserProfile];

ALTER TABLE [dbo].[VoidPaymentLevel] WITH CHECK CHECK CONSTRAINT [FK_VoidPaymentLevel_VoidPayment];

ALTER TABLE [dbo].[BranchStore] WITH CHECK CHECK CONSTRAINT [FK_BranchStore_Organization];

ALTER TABLE [dbo].[BranchStore] WITH CHECK CHECK CONSTRAINT [FK_BranchStore_UserProfile];

ALTER TABLE [dbo].[BranchStore] WITH CHECK CHECK CONSTRAINT [FK_BranchStore_UserProfile1];

ALTER TABLE [dbo].[LessonPriceType] WITH CHECK CHECK CONSTRAINT [FK_LessonPriceType_BranchStore];

ALTER TABLE [dbo].[LessonPriceType] WITH CHECK CHECK CONSTRAINT [FK_LessonPriceType_LessonPriceSeries];

ALTER TABLE [dbo].[TuitionAchievement] WITH CHECK CHECK CONSTRAINT [FK_TuitionAchievement_Payment];


GO
PRINT N'Update complete.';


GO
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.LessonTime SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.Payment SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.LessonAttendance SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.Settlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.CourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.ContractTrustTrack
	(
	TrustID int NOT NULL IDENTITY (1, 1),
	ContractID int NOT NULL,
	EventDate datetime NOT NULL,
	TrustType nvarchar(8) NOT NULL,
	SettlementID int NULL,
	LessonID int NULL,
	PaymentID int NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.ContractTrustTrack ADD CONSTRAINT
	PK_ContractTrustTrack PRIMARY KEY CLUSTERED 
	(
	TrustID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.ContractTrustTrack ADD CONSTRAINT
	FK_ContractTrustTrack_CourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.CourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO

GO

CREATE TABLE [dbo].[Settlement](
	[SettlementID] [int] IDENTITY(1,1) NOT NULL,
	[SettlementDate] [datetime] NOT NULL,
 CONSTRAINT [PK_Settlement] PRIMARY KEY CLUSTERED 
(
	[SettlementID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

go
ALTER TABLE dbo.ContractTrustTrack ADD CONSTRAINT
	FK_ContractTrustTrack_Settlement FOREIGN KEY
	(
	SettlementID
	) REFERENCES dbo.Settlement
	(
	SettlementID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.ContractTrustTrack ADD CONSTRAINT
	FK_ContractTrustTrack_Payment FOREIGN KEY
	(
	PaymentID
	) REFERENCES dbo.Payment
	(
	PaymentID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.ContractTrustTrack ADD CONSTRAINT
	FK_ContractTrustTrack_LessonTime FOREIGN KEY
	(
	LessonID
	) REFERENCES dbo.LessonTime
	(
	LessonID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.ContractTrustTrack SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.Settlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.CourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.ContractTrustSettlement
	(
	ContractID int NOT NULL,
	SettlementID int NOT NULL,
	TotalTrustAmount int NOT NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.ContractTrustSettlement ADD CONSTRAINT
	PK_ContractTrustSettlement PRIMARY KEY CLUSTERED 
	(
	ContractID,
	SettlementID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.ContractTrustSettlement ADD CONSTRAINT
	FK_ContractTrustSettlement_CourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.CourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.ContractTrustSettlement ADD CONSTRAINT
	FK_ContractTrustSettlement_Settlement FOREIGN KEY
	(
	SettlementID
	) REFERENCES dbo.Settlement
	(
	SettlementID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.ContractTrustSettlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.CourseContractTrust
	(
	ContractID int NOT NULL,
	CurrentSettlement int NOT NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.CourseContractTrust ADD CONSTRAINT
	PK_CourseContractTrust PRIMARY KEY CLUSTERED 
	(
	ContractID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.CourseContractTrust ADD CONSTRAINT
	FK_CourseContractTrust_CourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.CourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.CourseContractTrust ADD CONSTRAINT
	FK_CourseContractTrust_ContractTrustSettlement FOREIGN KEY
	(
	ContractID,
	CurrentSettlement
	) REFERENCES dbo.ContractTrustSettlement
	(
	ContractID,
	SettlementID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.CourseContractTrust SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractTrustSettlement ADD
	InitialTrustAmount int NOT NULL CONSTRAINT DF_ContractTrustSettlement_InitialTrustAmount DEFAULT 0
GO
ALTER TABLE dbo.ContractTrustSettlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.LessonTimeSettlement
	DROP CONSTRAINT FK_LessonTimeSettlement_Settlement
GO
ALTER TABLE dbo.ContractTrustTrack
	DROP CONSTRAINT FK_ContractTrustTrack_Settlement
GO
ALTER TABLE dbo.ContractTrustSettlement
	DROP CONSTRAINT FK_ContractTrustSettlement_Settlement
GO
ALTER TABLE dbo.Settlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractTrustSettlement ADD CONSTRAINT
	FK_ContractTrustSettlement_Settlement FOREIGN KEY
	(
	SettlementID
	) REFERENCES dbo.Settlement
	(
	SettlementID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.ContractTrustSettlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractTrustTrack ADD CONSTRAINT
	FK_ContractTrustTrack_Settlement FOREIGN KEY
	(
	SettlementID
	) REFERENCES dbo.Settlement
	(
	SettlementID
	) ON UPDATE  NO ACTION 
	 ON DELETE  SET NULL 
	
GO
ALTER TABLE dbo.ContractTrustTrack SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.LessonTimeSettlement ADD CONSTRAINT
	FK_LessonTimeSettlement_Settlement FOREIGN KEY
	(
	SettlementID
	) REFERENCES dbo.Settlement
	(
	SettlementID
	) ON UPDATE  NO ACTION 
	 ON DELETE  SET NULL 
	
GO
ALTER TABLE dbo.LessonTimeSettlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.CourseContractTrust
	DROP CONSTRAINT FK_CourseContractTrust_ContractTrustSettlement
GO
ALTER TABLE dbo.ContractTrustSettlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.CourseContractTrust ADD CONSTRAINT
	FK_CourseContractTrust_ContractTrustSettlement FOREIGN KEY
	(
	ContractID,
	CurrentSettlement
	) REFERENCES dbo.ContractTrustSettlement
	(
	ContractID,
	SettlementID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.CourseContractTrust SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
alter TABLE [dbo].[Settlement]
	add 
	[StartDate] [datetime] NOT NULL,
	[EndExclusiveDate] [datetime] NOT NULL
GO


BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.CourseContractType SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.LessonPriceType SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.CourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.Organization SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.EnterpriseCourseContract
	(
	ContractID int NOT NULL,
	CompanyID int NOT NULL
	)  ON [PRIMARY]
GO
DECLARE @v sql_variant 
SET @v = N'主鍵'
EXECUTE sp_addextendedproperty N'MS_Description', @v, N'SCHEMA', N'dbo', N'TABLE', N'EnterpriseCourseContract', N'COLUMN', N'CompanyID'
GO
ALTER TABLE dbo.EnterpriseCourseContract ADD CONSTRAINT
	PK_EnterpriseCourseContract PRIMARY KEY CLUSTERED 
	(
	ContractID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.EnterpriseCourseContract ADD CONSTRAINT
	FK_EnterpriseCourseContract_CourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.CourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.EnterpriseCourseContract ADD CONSTRAINT
	FK_EnterpriseCourseContract_Organization FOREIGN KEY
	(
	CompanyID
	) REFERENCES dbo.Organization
	(
	CompanyID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.EnterpriseCourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.EnterpriseCourseContent
	(
	ContractID int NOT NULL,
	PriceID int NOT NULL,
	Lessons int NULL,
	ContractType int NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.EnterpriseCourseContent ADD CONSTRAINT
	PK_EnterpriseCourseContent PRIMARY KEY CLUSTERED 
	(
	ContractID,
	PriceID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.EnterpriseCourseContent ADD CONSTRAINT
	FK_EnterpriseCourseContent_EnterpriseCourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.EnterpriseCourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.EnterpriseCourseContent ADD CONSTRAINT
	FK_EnterpriseCourseContent_LessonPriceType FOREIGN KEY
	(
	PriceID
	) REFERENCES dbo.LessonPriceType
	(
	PriceID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.EnterpriseCourseContent ADD CONSTRAINT
	FK_EnterpriseCourseContent_CourseContractType FOREIGN KEY
	(
	ContractType
	) REFERENCES dbo.CourseContractType
	(
	TypeID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.EnterpriseCourseContent SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContract
	DROP CONSTRAINT FK_EnterpriseCourseContract_Organization
GO
ALTER TABLE dbo.Organization SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContract
	DROP CONSTRAINT FK_EnterpriseCourseContract_CourseContract
GO
ALTER TABLE dbo.CourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.Tmp_EnterpriseCourseContract
	(
	ContractID int NOT NULL IDENTITY (1, 1),
	CompanyID int NOT NULL,
	Remark nvarchar(64) NULL,
	Subject nvarchar(64) NULL,
	ContractNo nvarchar(64) NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.Tmp_EnterpriseCourseContract SET (LOCK_ESCALATION = TABLE)
GO
DECLARE @v sql_variant 
SET @v = N'主鍵'
EXECUTE sp_addextendedproperty N'MS_Description', @v, N'SCHEMA', N'dbo', N'TABLE', N'Tmp_EnterpriseCourseContract', N'COLUMN', N'CompanyID'
GO
SET IDENTITY_INSERT dbo.Tmp_EnterpriseCourseContract OFF
GO
IF EXISTS(SELECT * FROM dbo.EnterpriseCourseContract)
	 EXEC('INSERT INTO dbo.Tmp_EnterpriseCourseContract (CompanyID)
		SELECT CompanyID FROM dbo.EnterpriseCourseContract WITH (HOLDLOCK TABLOCKX)')
GO
ALTER TABLE dbo.EnterpriseCourseContent
	DROP CONSTRAINT FK_EnterpriseCourseContent_EnterpriseCourseContract
GO
DROP TABLE dbo.EnterpriseCourseContract
GO
EXECUTE sp_rename N'dbo.Tmp_EnterpriseCourseContract', N'EnterpriseCourseContract', 'OBJECT' 
GO
ALTER TABLE dbo.EnterpriseCourseContract ADD CONSTRAINT
	PK_EnterpriseCourseContract_1 PRIMARY KEY CLUSTERED 
	(
	ContractID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.EnterpriseCourseContract ADD CONSTRAINT
	FK_EnterpriseCourseContract_Organization FOREIGN KEY
	(
	CompanyID
	) REFERENCES dbo.Organization
	(
	CompanyID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContent ADD CONSTRAINT
	FK_EnterpriseCourseContent_EnterpriseCourseContract1 FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.EnterpriseCourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.EnterpriseCourseContent SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.UserProfile SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.EnterpriseCourseMember
	(
	ContractID int NOT NULL,
	UID int NOT NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.EnterpriseCourseMember ADD CONSTRAINT
	PK_EnterpriseCourseMember PRIMARY KEY CLUSTERED 
	(
	ContractID,
	UID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.EnterpriseCourseMember ADD CONSTRAINT
	FK_EnterpriseCourseMember_EnterpriseCourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.EnterpriseCourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.EnterpriseCourseMember ADD CONSTRAINT
	FK_EnterpriseCourseMember_UserProfile FOREIGN KEY
	(
	UID
	) REFERENCES dbo.UserProfile
	(
	UID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.EnterpriseCourseMember SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContract ADD
	TotalCost int NULL
GO
ALTER TABLE dbo.EnterpriseCourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.RegisterLesson SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.Payment SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.RegisterLessonEnterprise
	(
	RegisterID int NOT NULL,
	ContractID int NOT NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.RegisterLessonEnterprise ADD CONSTRAINT
	PK_RegisterLessonEnterprise PRIMARY KEY CLUSTERED 
	(
	RegisterID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.RegisterLessonEnterprise ADD CONSTRAINT
	FK_RegisterLessonEnterprise_RegisterLesson FOREIGN KEY
	(
	RegisterID
	) REFERENCES dbo.RegisterLesson
	(
	RegisterID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.RegisterLessonEnterprise ADD CONSTRAINT
	FK_RegisterLessonEnterprise_EnterpriseCourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.EnterpriseCourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.RegisterLessonEnterprise SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.EnterpriseCoursePayment
	(
	PaymentID int NOT NULL,
	ContractID int NOT NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.EnterpriseCoursePayment ADD CONSTRAINT
	PK_EnterpriseCoursePayment PRIMARY KEY CLUSTERED 
	(
	PaymentID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.EnterpriseCoursePayment ADD CONSTRAINT
	FK_EnterpriseCoursePayment_EnterpriseCourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.EnterpriseCourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.EnterpriseCoursePayment ADD CONSTRAINT
	FK_EnterpriseCoursePayment_Payment FOREIGN KEY
	(
	PaymentID
	) REFERENCES dbo.Payment
	(
	PaymentID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.EnterpriseCoursePayment SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.LessonTimeSettlement
	DROP CONSTRAINT FK_LessonTimeSettlement_Settlement
GO
ALTER TABLE dbo.Settlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.LessonTimeSettlement
	DROP COLUMN SettlementID
GO
ALTER TABLE dbo.LessonTimeSettlement SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractPayment
	DROP CONSTRAINT FK_ContractPayment_CourseContract
GO
ALTER TABLE dbo.CourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractPayment WITH NOCHECK ADD CONSTRAINT
	FK_ContractPayment_CourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.CourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.ContractPayment SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractTrustTrack
	DROP CONSTRAINT FK_ContractTrustTrack_CourseContract
GO
ALTER TABLE dbo.CourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractTrustTrack ADD CONSTRAINT
	FK_ContractTrustTrack_CourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.CourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.ContractTrustTrack SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
DELETE FROM ContractTrustSettlement
WHERE   (ContractID NOT IN
                   (SELECT  ContractID
                   FROM     CourseContract))
go

BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.BranchStore SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContract ADD
	BranchID int NULL
GO
ALTER TABLE dbo.EnterpriseCourseContract ADD CONSTRAINT
	FK_EnterpriseCourseContract_BranchStore FOREIGN KEY
	(
	BranchID
	) REFERENCES dbo.BranchStore
	(
	BranchID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.EnterpriseCourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT

BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContent
	DROP CONSTRAINT FK_EnterpriseCourseContent_CourseContractType
GO
ALTER TABLE dbo.CourseContractType SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContent
	DROP COLUMN ContractType
GO
ALTER TABLE dbo.EnterpriseCourseContent SET (LOCK_ESCALATION = TABLE)
GO
COMMIT

BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.EnterpriseLessonType
	(
	TypeID int NOT NULL,
	Status int NULL,
	Description nvarchar(64) NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.EnterpriseLessonType ADD CONSTRAINT
	PK_EnterpriseLessonType PRIMARY KEY CLUSTERED 
	(
	TypeID
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.EnterpriseLessonType SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.RegisterLessonEnterprise ADD
	TypeID int NULL
GO
ALTER TABLE dbo.RegisterLessonEnterprise ADD CONSTRAINT
	FK_RegisterLessonEnterprise_EnterpriseLessonType FOREIGN KEY
	(
	TypeID
	) REFERENCES dbo.EnterpriseLessonType
	(
	TypeID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.RegisterLessonEnterprise SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
EXECUTE sp_rename N'dbo.EnterpriseCourseContent.PriceID', N'Tmp_TypeID', 'COLUMN' 
GO
EXECUTE sp_rename N'dbo.EnterpriseCourseContent.Tmp_TypeID', N'TypeID', 'COLUMN' 
GO
ALTER TABLE dbo.EnterpriseCourseContent ADD
	ListPrice int NULL
GO
ALTER TABLE dbo.EnterpriseCourseContent ADD CONSTRAINT
	FK_EnterpriseCourseContent_EnterpriseLessonType FOREIGN KEY
	(
	TypeID
	) REFERENCES dbo.EnterpriseLessonType
	(
	TypeID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.EnterpriseCourseContent SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContent ADD
	DurationInMinutes int NULL
GO
ALTER TABLE dbo.EnterpriseCourseContent SET (LOCK_ESCALATION = TABLE)
GO
COMMIT

BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContent
	DROP CONSTRAINT FK_EnterpriseCourseContent_LessonPriceType
GO
ALTER TABLE dbo.LessonPriceType SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContent SET (LOCK_ESCALATION = TABLE)
GO
COMMIT


BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.RegisterLessonEnterprise
	DROP CONSTRAINT FK_RegisterLessonEnterprise_EnterpriseLessonType
GO
ALTER TABLE dbo.EnterpriseLessonType SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContent SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.RegisterLessonEnterprise ADD CONSTRAINT
	FK_RegisterLessonEnterprise_EnterpriseCourseContent FOREIGN KEY
	(
	ContractID,
	TypeID
	) REFERENCES dbo.EnterpriseCourseContent
	(
	ContractID,
	TypeID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.RegisterLessonEnterprise SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContract ADD
	ValidFrom datetime NULL,
	Expiration datetime NULL
GO
ALTER TABLE dbo.EnterpriseCourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT

BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.GroupingLesson SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseContract ADD
	GroupingMemberCount int NOT NULL CONSTRAINT DF_EnterpriseCourseContract_GroupingMemberCount DEFAULT 1
GO
ALTER TABLE dbo.EnterpriseCourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseMember ADD
	GroupID int NULL
GO
ALTER TABLE dbo.EnterpriseCourseMember ADD CONSTRAINT
	FK_EnterpriseCourseMember_GroupingLesson FOREIGN KEY
	(
	GroupID
	) REFERENCES dbo.GroupingLesson
	(
	GroupID
	) ON UPDATE  NO ACTION 
	 ON DELETE  NO ACTION 
	
GO
ALTER TABLE dbo.EnterpriseCourseMember SET (LOCK_ESCALATION = TABLE)
GO
COMMIT

BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseMember
	DROP CONSTRAINT FK_EnterpriseCourseMember_GroupingLesson
GO
ALTER TABLE dbo.GroupingLesson SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.EnterpriseCourseMember ADD CONSTRAINT
	FK_EnterpriseCourseMember_GroupingLesson FOREIGN KEY
	(
	GroupID
	) REFERENCES dbo.GroupingLesson
	(
	GroupID
	) ON UPDATE  NO ACTION 
	 ON DELETE  SET NULL 
	
GO
ALTER TABLE dbo.EnterpriseCourseMember SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.RegisterLessonContract
	DROP CONSTRAINT FK_RegisterLessonContract_CourseContract
GO
ALTER TABLE dbo.CourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.RegisterLessonContract WITH NOCHECK ADD CONSTRAINT
	FK_RegisterLessonContract_CourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.CourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.RegisterLessonContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractTrustTrack
	DROP CONSTRAINT FK_ContractTrustTrack_Payment
GO
ALTER TABLE dbo.Payment SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractTrustTrack ADD CONSTRAINT
	FK_ContractTrustTrack_Payment FOREIGN KEY
	(
	PaymentID
	) REFERENCES dbo.Payment
	(
	PaymentID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.ContractTrustTrack SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractPayment
	DROP CONSTRAINT FK_ContractPayment_CourseContract
GO
ALTER TABLE dbo.CourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractPayment ADD CONSTRAINT
	FK_ContractPayment_CourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.CourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.ContractPayment SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractTrustTrack
	DROP CONSTRAINT FK_ContractTrustTrack_CourseContract
GO
ALTER TABLE dbo.CourseContract SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
BEGIN TRANSACTION
GO
ALTER TABLE dbo.ContractTrustTrack ADD CONSTRAINT
	FK_ContractTrustTrack_CourseContract FOREIGN KEY
	(
	ContractID
	) REFERENCES dbo.CourseContract
	(
	ContractID
	) ON UPDATE  NO ACTION 
	 ON DELETE  CASCADE 
	
GO
ALTER TABLE dbo.ContractTrustTrack SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
