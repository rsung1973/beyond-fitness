@using System.IO
@using System.Linq.Expressions

@using WebHome.Helper
@using WebHome.Models.Locale
@using WebHome.Models.ViewModel
@using WebHome.Models.DataEntity
@using WebHome.Controllers
@{

    ModelStateDictionary _modelState;
    ModelSource<UserProfile> models;
    LessonTime _model;

    _modelState = (ModelStateDictionary)ViewBag.ModelState;
    models = ((SampleController<UserProfile>)ViewContext.Controller).DataSource;
    _model = (LessonTime)this.Model;
}
@{
    UserProfile learner = (UserProfile)ViewBag.Learner;
    var plan = _model.AssertTrainingPlan(models, UID: learner.UID);
    var execution = plan.TrainingExecution;
}
<a href="javascript:addToFavorites();"> <i class="@(plan.FavoriteLesson.Any(f => f.UID == learner.UID) ? "myfavaroit like" : "myfavaroit")"></i> </a>
<script>
    //加入我的最愛課表
    function addToFavorites() {
        if ($(".myfavaroit.like").length > 0) {
            $(".myfavaroit.like").removeClass("like");
        } else {
            $(".myfavaroit").addClass("like");
        }

        $.post('@Html.Raw(Url.Action("SwitchLessonFavorite", "LessonConsole", new { plan.ExecutionID,learner.UID }))', {}, function (data) {
            if ($.isPlainObject(data)) {
                if (data.result) {
                }
            } else {
                $(data).appendTo($('body'));
            }
        });

    }
</script>