@using System.IO
@using System.Linq.Expressions

@using WebHome.Helper
@using WebHome.Models.Locale
@using WebHome.Models.ViewModel
@using WebHome.Models.DataEntity
@using WebHome.Controllers
@using Newtonsoft.Json

@{
    ModelSource<UserProfile> models;
    ModelStateDictionary _modelState;
    CourseContract _item;
    UserProfile _model;
    CourseContractQueryViewModel _viewModel;


    models = ((SampleController<UserProfile>)ViewContext.Controller).DataSource;
    _modelState = (ModelStateDictionary)ViewBag.ModelState;
    _model = (UserProfile)this.Model;
    _viewModel = (CourseContractQueryViewModel)ViewBag.ViewModel;
    _item = (CourseContract)ViewBag.DataItem;

}

<div class="row clearfix">
    <div class="col-12">
        <h4 class="card-outbound-header">懶人包</h4>
    </div>
    <div class="col-lg-2 col-md-3 col-sm-6">
        <div class="card">
            <div class="file">
                <a href='javascript:downloadPaymentReport(@Html.Raw(JsonConvert.SerializeObject(new {
                                                            PayoffDateFrom = DateTime.Today,
                                                            PayoffDateTo = DateTime.Today,
                                                            BypassCondition = true,
                                                            InvoiceType = (Naming.InvoiceTypeDefinition?)null,
                                                        })));'>
                    <div class="icon">
                        <i class="zmdi livicon livicon-evo" data-options="name: coins.svg; size: 60px; style: original; strokeWidth:2px; autoPlay:true"></i>
                    </div>
                    <div class="file-name">
                        <p class="m-b-5 text-muted">收款清單</p>
                        <small>本日 <span class="date text-muted">@($"{DateTime.Today:yyyy/MM/dd}")</span></small>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="col-lg-2 col-md-3 col-sm-6">
        <div class="card">
            <div class="file">
                <a href='javascript:downloadPaymentReport(@Html.Raw(JsonConvert.SerializeObject(new
                                                        {
                                                            PayoffDateFrom = DateTime.Today.FirstDayOfMonth().AddMonths(-1),
                                                            PayoffDateTo = DateTime.Today.FirstDayOfMonth().AddDays(-1),
                                                            BypassCondition = true,
                                                            InvoiceType = (Naming.InvoiceTypeDefinition?)null,
                                                        })));'>
                    <div class="icon">
                        <i class="zmdi livicon livicon-evo" data-options="name: us-dollar.svg; size: 60px; style: original; strokeWidth:2px; autoPlay:true"></i>
                    </div>
                    <div class="file-name">
                        <p class="m-b-5 text-muted">收款清單</p>
                        <small>上月 <span class="date text-muted">@($"{DateTime.Today.FirstDayOfMonth().AddMonths(-1):yyyy/MM}")</span></small>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="col-lg-2 col-md-3 col-sm-6">
        <div class="card">
            <div class="file">
                <a href="javascript:$('').launchDownload('@Html.Raw(Url.Action("CreateMonthlyPaymentReportXlsx","Payment"))', { 'settlementDate': '@($"{DateTime.Today.AddMonths(-1):yyyy/MM/dd}")' },'report',true);">
                    <div class="icon">
                        <i class="zmdi livicon livicon-evo" data-options="name: notebook.svg; size: 60px; style: original; strokeWidth:2px; autoPlay:true"></i>
                    </div>
                    <div class="file-name">
                        <p class="m-b-5 text-muted">課程顧問費用會計明細帳</p>
                        <small>上月 <span class="date text-muted">@($"{DateTime.Today.AddMonths(-1):yyyy/MM}")</span></small>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="col-lg-2 col-md-3 col-sm-6">
        <div class="card">
            <div class="file">
                <a href="javascript:$('').launchDownload('@Html.Raw(Url.Action("CreateAccountsReceivableXlsx","Accounting"))',{'BypassCondition':true},'report',true);">
                    <div class="icon">
                        <i class="zmdi livicon livicon-evo" data-options="name: dislike.svg; size: 60px; style: original; strokeWidth:2px; autoPlay:true"></i>
                    </div>
                    <div class="file-name">
                        <p class="m-b-5 text-muted">催收帳款清單</p>
                        <small>截至目前 <span class="date text-muted">@($"{DateTime.Today:yyyy/MM/dd}")</span></small>
                    </div>
                </a>
            </div>
        </div>
    </div>
</div>
<div class="row clearfix">
    <div class="col-12">
        <h4 class="card-outbound-header">自訂條件</h4>
    </div>
    <div class="col-lg-2 col-md-3 col-sm-6">
        <div class="card">
            <div class="file">
                <a href="javascript:selectPeriodPaymentReport();">
                    <div class="icon">
                        <i class="zmdi livicon livicon-evo" data-options="name: us-dollar.svg; size: 60px; style: original; strokeWidth:2px; autoPlay:true"></i>
                    </div>
                    <div class="file-name">
                        <p class="m-b-5 text-muted">收款清單</p>
                        <small>自訂條件 <span class="date text-muted"><i class="zmdi zmdi-search"></i></span></small>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="col-lg-2 col-md-3 col-sm-6">
        <div class="card">
            <div class="file">
                <a href="javascript:selectMonthlyAccountingReport();">
                    <div class="icon">
                        <i class="zmdi livicon livicon-evo" data-options="name: notebook.svg; size: 60px; style: original; strokeWidth:2px; autoPlay:true"></i>
                    </div>
                    <div class="file-name">
                        <p class="m-b-5 text-muted">課程顧問費用會計明細帳</p>
                        <small>自訂條件 <span class="date text-muted"><i class="zmdi zmdi-search"></i></span></small>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <script>
        function selectPeriodPaymentReport() {
            showLoading();
            $.post('@Html.Raw(Url.Action("SelectPeriodReport","ReportConsole"))', {}, function (data) {
                hideLoading();
                if ($.isPlainObject(data)) {
                    swal(data.message);
                } else {
                    $global.doQuery = function (viewModel) {
                        viewModel.PayoffDateFrom = viewModel.DateFrom;
                        viewModel.PayoffDateTo = viewModel.DateTo;
                        viewModel.InvoiceType = null;
                        downloadPaymentReport(viewModel);
                    }
                    $(data).appendTo($('body'));
                }
            });
        }

        function selectMonthlyAccountingReport() {
            showLoading();
            $.post('@Html.Raw(Url.Action("SelectMonthlyReport","ReportConsole"))', {}, function (data) {
                hideLoading();
                if ($.isPlainObject(data)) {
                    swal(data.message);
                } else {
                    $global.doQuery = function (settlementDate) {
                        $('').launchDownload('@Html.Raw(Url.Action("CreateMonthlyPaymentReportXlsx","Payment"))', { 'settlementDate': settlementDate }, 'report',true);
                    }
                    $(data).appendTo($('body'));
                }
            });
        }

        function downloadPaymentReport(viewModel) {
            $('').launchDownload('@Html.Raw(Url.Action("CreatePaymentInvoiceQueryXlsx","Payment"))', viewModel, 'report', true);
        }
    </script>
</div>